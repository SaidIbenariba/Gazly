ex7 TD2 
add table Alert_Products(refprod, designationprod, prixprod) 

DELIMITER// 
CREATE PROCEDURE insert_produit_notcommande() 
BEGIN
DELCARE designation VARCHAR(30); 
DELCARE reference INT; 
DECLARE prix FLOAT;
DECLARE exist INT DEFAULT 0 ; 
DECLARE done INT DEFAULT 1; 



DECLARE curseur_produit CURSOR FOR SELECT Reference, Designation, Prix
FROM produit; 
DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1; 
OPEN curseur_produit; 
read_loop :LOOP 
FETCH curseur_produit INTO reference, designation, prix ;
IF done THEN 
 LEAVE read_loop ; 
END IF; 
SELECT COUNT(Refprod) INTO exist FROM Lignedecommande WHERE Refprod = reference ;	
IF exist THEN 
 CONTINUE
END IF; 
INSERT INTO Alert_Products(refprod, designationprod, prixprod) VALUES ( reference, designation, prix) ; 
SELECT designation as Designation; 


 

END // 
DELIMITER; 